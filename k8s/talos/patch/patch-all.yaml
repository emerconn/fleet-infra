# TODO: change node names, eg. cp-01.talos-cluster.homelab.emerconnelly.com

cluster:
  network:
    cni:
      name: none # manually install Cillium
  proxy:
    disabled: true # manually install Cillium
    image: registry.k8s.io/kube-proxy:v1.31.3
  apiServer:
    image: registry.k8s.io/kube-apiserver:v1.31.2
  controllerManager:
    image: registry.k8s.io/kube-controller-manager:v1.31.3
  scheduler:
    image: registry.k8s.io/kube-scheduler:v1.31.3
  allowSchedulingOnControlPlanes: true

machine:
  install:
    image: factory.talos.dev/installer/0b4f48281e59712995bea152e8e62f3082be4ab66d2bdd0ca83cb3ce8c4509a9:v1.9.0-beta.1
    # intel-ucode, i915-ucode, iscsi-tools & btrfs
    disk: /dev/sda
    wipe: true
    extraKernelArgs:
    - talos.platform=metal
    - cpufreq.default_governor=performance
    - intel_idle.max_cstate=0
  kubelet:
    image: ghcr.io/siderolabs/kubelet:v1.31.3
    extraArgs:
      rotate-server-certificates: true
  time:
    servers:
    - time.cloudflare.com
