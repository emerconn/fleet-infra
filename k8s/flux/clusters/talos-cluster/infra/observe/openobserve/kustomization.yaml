# yaml-language-server: $schema=https://json.schemastore.org/kustomization
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ceph-bucket.yaml
- ingress.yaml
- secret-sops-openobserve-auth.yaml
- ../../../../../infra/observe/openobserve.yaml
patches:
- patch: |-
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: openobserve
      namespace: flux-system
    spec:
      values:
        externalSecret:
          enabled: true
          name: "openobserve-auth"
        config:
          ZO_S3_SERVER_URL: "http://rook-ceph-rgw-ceph-objectstore.rook-ceph.svc"
          rook-ceph-rgw-ceph-objectstore.rook-ceph.svc
          ZO_S3_BUCKET_NAME: "openobserve-21106f10-7d58-4834-9878-379bbd96903e"
          ZO_S3_PROVIDER: "s3"
          ZO_COMPACT_DATA_RETENTION_DAYS: "7"
        postgres:
          spec:
            storage:
              size: 50Gi
