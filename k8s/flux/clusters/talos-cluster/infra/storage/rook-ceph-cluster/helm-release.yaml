apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: rook-ceph-cluster
  namespace: flux-system
spec:
  values:
    operatorNamespace: rook-ceph
    clusterName: rook-ceph
    monitoring:
      enabled: true
      createPrometheusRules: false
      rulesNamespaceOverride: kube-prometheus-stack
    cephClusterSpec:
      dashboard:
        enabled: true
        ssl: false
      mgr:
        modules:
        - name: rook
          enabled: true
      removeOSDsIfOutAndSafeToRemove: true
    cephBlockPools:
    - name: ceph-blockpool
      storageClass:
        enabled: true
        name: ceph-block-delete
        isDefault: false
        reclaimPolicy: Delete
    cephObjectStores:
    - name: ceph-objectstore
      storageClass:
        enabled: true
        name: ceph-bucket-delete
        isDefault: false
        reclaimPolicy: Delete
    cephFileSystems:
    - name: ceph-filesystem-retain
      storageClass:
        enabled: true
        name: ceph-ext4-retain
        isDefault: false
        reclaimPolicy: Retain
        parameters:
          csi.storage.k8s.io/provisioner-secret-name: rook-csi-cephfs-provisioner
          csi.storage.k8s.io/provisioner-secret-namespace: rook-ceph
          csi.storage.k8s.io/controller-expand-secret-name: rook-csi-cephfs-provisioner
          csi.storage.k8s.io/controller-expand-secret-namespace: rook-ceph
          csi.storage.k8s.io/node-stage-secret-name: rook-csi-cephfs-node
          csi.storage.k8s.io/node-stage-secret-namespace: rook-ceph
